<section class="custom-grid">
  <div
    class="container"
    data-bonus-handle="{% if section.settings.bonus_product != blank %}{{ all_products[section.settings.bonus_product].handle }}{% endif %}"
    data-trigger-color="{{ section.settings.trigger_color | downcase }}"
    data-trigger-size="{{ section.settings.trigger_size | downcase }}"
  >
    <div class="grid6">
      {% for block in section.blocks %}
        {% assign product = all_products[block.settings.product] %}
        {% if product %}
          <article class="card" {{ block.shopify_attributes }}>
            <img class="card__img" src="{{ product.featured_image | img_url: '600x600' }}" alt="{{ product.title | escape }}">
            <div class="card__body">
              <div class="card__title">{{ product.title }}</div>
              <div class="card__price">
                {% if product.compare_at_price_min > product.price_min %}
                  <s>{{ product.compare_at_price_min | money }}</s>&nbsp;
                {% endif %}
                {{ product.price_min | money }}
              </div>
              <div class="card__actions">
                <button class="btn js-qv-open" data-handle="{{ product.handle }}">Quick View</button>
              </div>
            </div>
          </article>
        {% endif %}
      {% endfor %}
    </div>
  </div>

  <!-- Quick View popup (one instance reused for all products) -->
  <div class="qv" aria-hidden="true">
    <div class="qv__panel">
      <button class="qv__close" aria-label="Close">Ã—</button>
      <div class="qv__media">
        <img alt="">
      </div>
      <div class="qv__content">
        <h2 class="qv__title"></h2>
        <div class="qv__price"></div>
        <div class="qv__desc"></div>
        <div class="qv__options"></div>
        <div class="qv__footer">
          <button class="btn js-qv-add">ADD TO CART</button>
        </div>
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Custom Grid (6 Products)",
  "settings": [
    { "type":"product", "id":"bonus_product", "label":"Bonus product to auto-add (Soft Winter Jacket)" },
    { "type":"text", "id":"trigger_color", "label":"Auto-add trigger color", "default":"Black" },
    { "type":"text", "id":"trigger_size",  "label":"Auto-add trigger size",  "default":"Medium" }
  ],
  "blocks": [
    {
      "type": "product_card",
      "name": "Product",
      "settings": [
        { "type":"product", "id":"product", "label":"Pick product" }
      ]
    }
  ],
  "max_blocks": 6,
  "presets": [
    {
      "name": "Custom Grid (6 Products)",
      "blocks": [
        { "type":"product_card" }, { "type":"product_card" }, { "type":"product_card" },
        { "type":"product_card" }, { "type":"product_card" }, { "type":"product_card" }
      ]
    }
  ]
}
{% endschema %}